# Homework 1, Statistical rethinking
 Jaime Ashander

<!--roptions dev=png,width=5,height=5 -->

<!--begin.rcode,echo=FALSE
require(bbmle)
require(rethinking)
require(ggplot2)
end.rcode-->

# Problem 1  

First load the data, `birth1` and `birth2`, which indicate the gender (male=1, female=0) of reported first (second) born children in 100 families.
All families in this country have a maximum of two children.

<!--begin.rcode problem1_setup, message=FALSE
data(homeworkch2) #
end.rcode-->

## 1 a

  Data are generated by binomial trials with probability of obtaining a boy `p.b`, 

<!--begin.rcode prob1a, message=FALSE
 p.b = seq(from=0, to=1, length.out=1000)
 prior = rep(1/1000, 1000)
 likelihood =  dbinom(sum(birth1)+sum(birth2), size=length(c(birth1,birth2)), prob=p.b) # likelihood of data given 1000 models (binomial success parameter)
 naive.posterior = prior * likelihood
 pb.max =  p.b[-log(likelihood) == min(-log(likelihood))]
end.rcode-->

  The model `p.b = 1` maximizes the posterior probability at the value
<!--begin.rcode prob1a, message=FALSE, echo=FALSE
print(pb.max)
end.rcode-->


## 1 b

<!--begin.rcode prob1b, message=FALSE
p.b.sample = sample(p.b, size=1e4, replace=TRUE, prob=naive.posterior)
p.b.sample = p.b.sample[order(p.b.sample)]
post.50 = c(p.b.sample[2500], p.b.sample[7500])
post.90 = c(p.b.sample[500], p.b.sample[9500])
post.95 = c(p.b.sample[250], p.b.sample[9750])
end.rcode-->

Posterior density intervals for probabilty of drawing a boy:
  
<!--begin.rcode prob1b, message=FALSE, echo=FALSE
cat( " 50 % interval: ", post.50, "\n")
cat( " 90 % interval: ", post.90, "\n")
cat( " 95 % interval: ", post.95, "\n")
end.rcode-->

<!--begin.rcode prob1a_fig, message=FALSE, fig=TRUE
dat = data.frame(prior=prior, likelihood=likelihood, posterior=naive.posterior, probability.boy=p.b)
g = ggplot(dat)+geom_vline(xintercept=pb.max,color='red')
g = g + geom_vline(xintercept=post.50,color='blue')
g = g + geom_vline(xintercept=post.90,color='orange')
g = g + geom_vline(xintercept=post.95,color='green')
g = g+geom_line(aes(probability.boy, posterior))    
g
end.rcode-->

## 1c

  
# Colophon 

Written using the excellent [knitr](http://yihui.github.com/knitr/).

Need to use not only the options below suggested by knitr docs

<!--begin.rcode eval=FALSE
opts_knit$set(base.url="https://github.com/ashander/stat-rethink/raw/master/")
end.rcode-->

but also 

<!--begin.rcode eval=FALSE
opts_knit$set(out.format='gfm')
end.rcode-->

